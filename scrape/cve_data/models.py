from django.db import models

class Vendor(models.Model):
    vendor_name = models.CharField(max_length=64)

class VendorProduct(models.Model):
    product_name = models.CharField(max_length=64)
    vendor = models.ForeignKey(Vendor)

class VendorProductVersion(models.Model):
    version_value = models.CharField(max_length=64)
    vendor_product = models.ForeignKey(VendorProduct)

# The individual CVE object
class CVE(models.Model):
    cve_id = models.CharField(max_length=32)
    description = models.CharField(max_length=2048, blank=True, null=True)
    date = models.DateField()

# Type of Score (e.g. Impact, Exploitability)
class ScoreType(models.Model):
    name = models.CharField(max_length=32)
    description = models.CharField(max_length=1024, blank=True, null=True)

# Type of Metric that NIST is using
class MetricType(models.Model):
    name = models.CharField(max_length=32)
    description = models.CharField(max_length=1024, blank=True, null=True)

# Score per metric for a particular CVE
class CVEScore(models.Model):
    cve = models.ForeignKey(CVE)
    score_type = models.ForeignKey(ScoreType)
    metric_type = models.ForeignKey(MetricType)
    value = models.DecimalField(max_digits=3, decimal_places=1)
    severity = models.CharField(max_length=32)

# URL link for CVE information
class ReferenceURL(models.Model):
    url = models.CharField(max_length=2048)
    cve = models.ForeignKey(CVE)

