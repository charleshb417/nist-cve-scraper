from django.db import models

class Vendor(models.Model):
    vendor_name = models.CharField(max_length=64)

class VendorProduct(models.Model):
    product_name = models.CharField(max_length=64)
    vendor = models.ForeignKey(Vendor)

class VendorProductVersion(models.Model):
    version_value = models.CharField(max_length=64)
    vendor_product = models.ForeignKey(VendorProduct)

class CVE(models.Model):
    cve_id = models.CharField(max_length=32)
    description = models.CharField(max_length=2048, blank=True, null=True)
    date = models.DateField()

class ScoreType(models.Model):
    name = models.CharField(max_length=32)
    description = models.CharField(max_length=1024, blank=True, null=True)

class MetricType(models.Model):
    name = models.CharField(max_length=32)
    description = models.CharField(max_length=1024, blank=True, null=True)

class CVEScore(models.Model):
    cve = models.ForeignKey(CVE)
    score_type = models.ForeignKey(ScoreType)
    metric_type = models.ForeignKey(MetricType)
    value = models.DecimalField(max_digits=3, decimal_places=1)
    severity = models.CharField(max_length=32)

class ReferenceURL(models.Model):
    url = models.CharField(max_length=2048)
    cve = models.ForeignKey(CVE)

